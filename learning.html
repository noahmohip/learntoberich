<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Chapter 1 — Intro to Accounting & Business | Accounting By Noah</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;0,900;1,700&family=DM+Sans:wght@300;400;500;600&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0d1117;
      --surface: #161b22;
      --surface2: #1c2333;
      --surface3: #222d3e;
      --border: rgba(255,255,255,.08);
      --border2: rgba(255,255,255,.13);
      --text: #e8edf3;
      --muted: #8b96a8;
      --muted2: #6a7585;
      --gold: #d4a843;
      --gold-dim: rgba(212,168,67,.12);
      --green: #2dba7e;
      --green-dim: rgba(45,186,126,.11);
      --green-bright: rgba(45,186,126,.25);
      --red: #f06060;
      --red-dim: rgba(240,96,96,.1);
      --blue: #4f9cf9;
      --radius: 14px;
      --radius-sm: 9px;
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }

    body {
      font-family: 'DM Sans', system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
      font-size: 16px;
    }

    /* ===== NAV ===== */
    nav {
      position: sticky;
      top: 0;
      z-index: 100;
      height: 64px;
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 0 32px;
      background: rgba(13,17,23,.9);
      backdrop-filter: blur(16px);
      border-bottom: 1px solid var(--border);
    }

    .nav-brand {
      display: flex;
      align-items: center;
      gap: 10px;
      text-decoration: none;
      color: var(--text);
    }

    .nav-logo {
      width: 38px; height: 38px;
      border-radius: 9px;
      display: grid;
      place-items: center;
      overflow: hidden;
      flex-shrink: 0;
      background: rgba(255,255,255,.03);
      border: 1px solid var(--border);
      box-shadow: 0 0 14px rgba(45,186,126,.16);
    }
    .nav-logo img {
      width: 100%; height: 100%;
      object-fit: contain;
      display: block;
    }

    .nav-brand-text {
      font-family: 'Playfair Display', serif;
      font-size: 15px;
      font-weight: 700;
      line-height: 1.2;
    }

    .nav-brand-text small {
      display: block;
      font-family: 'DM Sans', sans-serif;
      font-size: 10px;
      font-weight: 400;
      color: var(--muted);
      letter-spacing: .04em;
      text-transform: uppercase;
    }

    .nav-spacer { flex: 1; }

    .nav-pill {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 7px 14px;
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 8px;
      font-size: 13px;
      color: var(--muted);
    }

    .nav-pill select {
      border: none;
      background: transparent;
      font-family: 'DM Sans', sans-serif;
      font-size: 13px;
      font-weight: 600;
      color: var(--text);
      outline: none;
      cursor: pointer;
      max-width: 260px;
    }

    .nav-pill select option { background: #1c2333; color: var(--text); }

    .nav-btn {
      padding: 8px 16px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: var(--surface2);
      color: var(--text);
      font-family: 'DM Sans', sans-serif;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: border-color .15s, background .15s;
      white-space: nowrap;
    }

    .nav-btn:hover { border-color: var(--border2); background: var(--surface3); }

    .nav-btn.green {
      background: var(--green);
      color: #071a10;
      border-color: transparent;
    }

    .nav-btn.green:hover { opacity: .85; }

    /* ===== LAYOUT ===== */
    .wrap {
      display: grid;
      grid-template-columns: 280px 1fr;
      max-width: 1400px;
      margin: 0 auto;
      gap: 24px;
      padding: 24px 24px 80px;
      align-items: start;
    }

    @media (max-width: 920px) {
      .wrap { grid-template-columns: 1fr; }
      .sidebar { display: none; }
    }

    /* ===== SIDEBAR ===== */
    .sidebar {
      position: sticky;
      top: 88px;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      overflow: hidden;
    }

    .sidebar-head {
      padding: 20px 18px 16px;
      background: var(--surface2);
      border-bottom: 1px solid var(--border);
    }

    .sidebar-label {
      font-family: 'DM Mono', monospace;
      font-size: 10px;
      font-weight: 500;
      letter-spacing: .1em;
      text-transform: uppercase;
      color: var(--gold);
      margin-bottom: 4px;
    }

    .sidebar-title {
      font-family: 'Playfair Display', serif;
      font-size: 16px;
      font-weight: 700;
      line-height: 1.3;
    }

    .sidebar-sub {
      margin-top: 6px;
      font-size: 12px;
      color: var(--muted);
      line-height: 1.5;
    }

    .ch-list { padding: 12px; display: grid; gap: 6px; }

    .ch-btn {
      width: 100%;
      text-align: left;
      border: 1px solid transparent;
      background: transparent;
      padding: 10px 12px;
      border-radius: 9px;
      cursor: pointer;
      display: flex;
      align-items: flex-start;
      gap: 10px;
      transition: background .15s, border-color .15s;
      color: var(--text);
    }

    .ch-btn:hover { background: var(--surface2); border-color: var(--border); }
    .ch-btn.active { background: var(--green-dim); border-color: var(--green-bright); }

    .ch-num {
      width: 30px; height: 30px;
      border-radius: 8px;
      background: var(--surface2);
      display: grid;
      place-items: center;
      font-family: 'DM Mono', monospace;
      font-size: 12px;
      font-weight: 500;
      color: var(--muted);
      flex-shrink: 0;
    }

    .ch-btn.active .ch-num {
      background: var(--green-dim);
      color: var(--green);
    }

    .ch-text b {
      font-size: 13px;
      font-weight: 600;
      line-height: 1.35;
      display: block;
    }

    .ch-text span {
      font-size: 11px;
      color: var(--muted);
      margin-top: 2px;
      display: block;
    }

    .ch-btn.active .ch-text b { color: var(--text); }

    /* ===== MAIN CONTENT ===== */
    .content {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 18px;
      overflow: hidden;
    }

    /* HERO BAND */
    .ch-hero {
      padding: 48px 40px 38px;
      background:
        radial-gradient(700px 280px at 0% 50%, rgba(45,186,126,.09), transparent),
        radial-gradient(600px 260px at 100% 50%, rgba(212,168,67,.07), transparent),
        var(--surface2);
      border-bottom: 1px solid var(--border);
      position: relative;
      overflow: hidden;
    }

    .ch-hero::before {
      content: '';
      position: absolute;
      inset: 0;
      background-image:
        linear-gradient(rgba(255,255,255,.018) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255,255,255,.018) 1px, transparent 1px);
      background-size: 48px 48px;
    }

    .ch-hero-inner { position: relative; z-index: 1; }

    .ch-tag {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-family: 'DM Mono', monospace;
      font-size: 10px;
      font-weight: 500;
      letter-spacing: .1em;
      text-transform: uppercase;
      color: var(--green);
      background: var(--green-dim);
      border: 1px solid rgba(45,186,126,.2);
      padding: 5px 12px;
      border-radius: 999px;
      margin-bottom: 20px;
    }

    .ch-tag::before {
      content: '';
      width: 5px; height: 5px;
      border-radius: 50%;
      background: var(--green);
    }

    .ch-hero h1 {
      font-family: 'Playfair Display', serif;
      font-size: clamp(28px, 4vw, 40px);
      font-weight: 900;
      letter-spacing: -.02em;
      line-height: 1.15;
    }

    .ch-hero p {
      margin-top: 16px;
      color: var(--muted);
      font-size: 15px;
      line-height: 1.75;
      max-width: 760px;
    }

    .ch-hero-actions {
      margin-top: 28px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .jump-btn {
      padding: 9px 18px;
      border-radius: 8px;
      background: var(--surface);
      border: 1px solid var(--border);
      color: var(--text);
      font-family: 'DM Sans', sans-serif;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      transition: border-color .15s, background .15s;
      text-decoration: none;
    }

    .jump-btn:hover { border-color: var(--border2); background: var(--surface3); }

    .jump-btn.primary {
      background: var(--green);
      color: #071a10;
      border-color: transparent;
    }

    .jump-btn.primary:hover { opacity: .85; }

    /* ===== SECTIONS ===== */
    .section {
      padding: 36px 40px;
      border-top: 1px solid var(--border);
    }

    .section-title-row {
      display: flex;
      align-items: baseline;
      gap: 14px;
      margin-bottom: 8px;
    }

    .obj-badge {
      font-family: 'DM Mono', monospace;
      font-size: 10px;
      font-weight: 500;
      color: var(--gold);
      letter-spacing: .1em;
      text-transform: uppercase;
      white-space: nowrap;
    }

    .section h2 {
      font-family: 'Playfair Display', serif;
      font-size: 26px;
      font-weight: 900;
      letter-spacing: -.01em;
      line-height: 1.2;
    }

    .section-intro {
      color: var(--muted);
      font-size: 15px;
      line-height: 1.75;
      max-width: 820px;
      margin-top: 10px;
      margin-bottom: 28px;
    }

    /* TERM GRID */
    .terms { display: grid; gap: 12px; }

    .term {
      display: flex;
      gap: 14px;
      align-items: flex-start;
      padding: 16px;
      border-radius: 11px;
      background: var(--surface2);
      border: 1px solid var(--border);
    }

    .term-tag {
      font-family: 'DM Mono', monospace;
      font-size: 10px;
      font-weight: 500;
      padding: 5px 10px;
      border-radius: 6px;
      background: var(--surface3);
      border: 1px solid var(--border);
      color: var(--muted);
      white-space: nowrap;
      flex-shrink: 0;
      letter-spacing: .04em;
    }

    .term-body {
      font-size: 14px;
      line-height: 1.7;
      color: var(--text);
    }

    .term-body b { color: var(--text); font-weight: 600; }

    /* EQUATION BOX */
    .eq-box {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      padding: 16px 20px;
      border: 1px dashed rgba(45,186,126,.3);
      border-radius: 11px;
      background: var(--green-dim);
      margin: 20px 0;
    }

    .eq-box code {
      font-family: 'DM Mono', monospace;
      font-size: 15px;
      font-weight: 500;
      color: var(--green);
    }

    .copy-btn {
      padding: 6px 12px;
      border-radius: 6px;
      background: transparent;
      border: 1px solid rgba(45,186,126,.3);
      color: var(--green);
      font-family: 'DM Mono', monospace;
      font-size: 11px;
      cursor: pointer;
      flex-shrink: 0;
      transition: background .15s;
    }

    .copy-btn:hover { background: var(--green-dim); }

    /* QUIZ */
    .quiz-block {
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 11px;
      padding: 20px;
      margin-top: 20px;
    }

    .quiz-label {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 12px;
    }

    .quiz-input {
      width: 100%;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 10px 14px;
      font-family: 'DM Sans', sans-serif;
      font-size: 14px;
      font-weight: 500;
      color: var(--text);
      outline: none;
      transition: border-color .15s;
    }

    .quiz-input:focus { border-color: var(--green); }

    .quiz-row {
      display: flex;
      gap: 10px;
      align-items: center;
      margin-top: 10px;
      flex-wrap: wrap;
    }

    .quiz-check-btn {
      padding: 9px 20px;
      border-radius: 8px;
      background: var(--green);
      color: #071a10;
      border: none;
      font-family: 'DM Sans', sans-serif;
      font-size: 13px;
      font-weight: 700;
      cursor: pointer;
      transition: opacity .15s;
    }

    .quiz-check-btn:hover { opacity: .85; }

    .result-badge {
      display: none;
      padding: 6px 12px;
      border-radius: 6px;
      font-family: 'DM Mono', monospace;
      font-size: 12px;
      font-weight: 500;
    }

    .result-badge.show { display: inline-block; }
    .result-badge.good { background: var(--green-dim); border: 1px solid rgba(45,186,126,.25); color: var(--green); }
    .result-badge.bad { background: var(--red-dim); border: 1px solid rgba(240,96,96,.25); color: var(--red); }
    .result-badge.warn { background: var(--gold-dim); border: 1px solid rgba(212,168,67,.25); color: var(--gold); }

    .quiz-hint {
      font-size: 12px;
      color: var(--muted2);
    }

    /* FLASHCARD */
    .flashcard {
      cursor: pointer;
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 36px 28px;
      text-align: center;
      font-family: 'Playfair Display', serif;
      font-size: 18px;
      font-weight: 700;
      line-height: 1.5;
      min-height: 120px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 20px;
      user-select: none;
      transition: border-color .2s, background .2s, transform .15s;
    }

    .flashcard:hover { border-color: var(--border2); transform: translateY(-2px); }
    .flashcard.flipped { background: var(--green-dim); border-color: rgba(45,186,126,.3); color: var(--green); }

    /* GAAP GRID */
    .gaap-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
      margin-top: 20px;
    }

    @media (max-width: 700px) { .gaap-grid { grid-template-columns: 1fr; } }

    .gaap-card {
      padding: 18px;
      border-radius: 11px;
      background: var(--surface2);
      border: 1px solid var(--border);
    }

    .gaap-card-label {
      font-family: 'DM Mono', monospace;
      font-size: 10px;
      color: var(--gold);
      font-weight: 500;
      letter-spacing: .1em;
      text-transform: uppercase;
      margin-bottom: 8px;
    }

    .gaap-card p {
      font-size: 13px;
      color: var(--muted);
      line-height: 1.7;
    }

    .gaap-card b { color: var(--text); font-weight: 600; }

    /* ===== SIMULATOR ===== */
    .sim-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      margin-bottom: 16px;
    }

    .sim-header h3 {
      font-family: 'Playfair Display', serif;
      font-size: 20px;
      font-weight: 700;
    }

    .sim-controls { display: flex; gap: 8px; }

    .sim-btn {
      padding: 7px 14px;
      border-radius: 7px;
      background: var(--surface2);
      border: 1px solid var(--border);
      color: var(--text);
      font-family: 'DM Sans', sans-serif;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: border-color .15s;
    }

    .sim-btn:hover { border-color: var(--border2); }
    .sim-btn.active { background: var(--green-dim); border-color: rgba(45,186,126,.3); color: var(--green); }

    .slider-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }

    @media (max-width: 700px) { .slider-grid { grid-template-columns: 1fr; } }

    .slider-card {
      padding: 16px;
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 11px;
    }

    .slider-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .slider-label {
      font-family: 'DM Mono', monospace;
      font-size: 12px;
      font-weight: 500;
      color: var(--muted);
      letter-spacing: .04em;
    }

    .slider-val {
      font-family: 'DM Mono', monospace;
      font-size: 14px;
      font-weight: 500;
      color: var(--green);
    }

    input[type="range"] {
      -webkit-appearance: none;
      width: 100%;
      height: 4px;
      background: var(--surface3);
      border-radius: 2px;
      outline: none;
    }

    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 18px; height: 18px;
      border-radius: 50%;
      background: var(--green);
      cursor: pointer;
      box-shadow: 0 0 8px rgba(45,186,126,.4);
    }

    input[type="range"]::-moz-range-thumb {
      width: 18px; height: 18px;
      border-radius: 50%;
      background: var(--green);
      cursor: pointer;
      border: none;
    }

    .slider-mini {
      font-size: 12px;
      color: var(--muted2);
      line-height: 1.55;
      margin-top: 10px;
    }

    .slider-mini b { color: var(--text); }

    .eq-line-display {
      margin-top: 14px;
      padding: 14px 18px;
      border-radius: 10px;
      background: var(--surface2);
      border: 1px dashed rgba(45,186,126,.25);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

    .eq-line-display code {
      font-family: 'DM Mono', monospace;
      font-size: 13px;
      color: var(--text);
    }

    #eqStatus {
      font-family: 'DM Mono', monospace;
      font-size: 12px;
      font-weight: 500;
      white-space: nowrap;
    }

    /* ===== JOURNAL ENTRY TOOL ===== */
    .je-grid {
      display: grid;
      grid-template-columns: 1fr 1fr 140px 120px;
      gap: 10px;
      margin-bottom: 12px;
    }

    @media (max-width: 800px) { .je-grid { grid-template-columns: 1fr 1fr; } }

    .je-select, .je-input {
      width: 100%;
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 10px 12px;
      font-family: 'DM Sans', sans-serif;
      font-size: 14px;
      font-weight: 500;
      color: var(--text);
      outline: none;
      transition: border-color .15s;
    }

    .je-select:focus, .je-input:focus { border-color: var(--green); }
    .je-select option { background: #1c2333; }

    .je-row {
      display: flex;
      gap: 8px;
      align-items: center;
      flex-wrap: wrap;
      margin-top: 6px;
    }

    .je-btn {
      padding: 9px 18px;
      border-radius: 8px;
      border: none;
      font-family: 'DM Sans', sans-serif;
      font-size: 13px;
      font-weight: 700;
      cursor: pointer;
    }

    .je-btn.add { background: var(--green); color: #071a10; }
    .je-btn.add:hover { opacity: .85; }
    .je-btn.undo { background: var(--surface2); border: 1px solid var(--border); color: var(--text); }
    .je-btn.reset { background: var(--red-dim); border: 1px solid rgba(240,96,96,.2); color: var(--red); }
    .je-btn.undo:hover, .je-btn.reset:hover { border-color: var(--border2); }

    .balances-row {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 12px;
      margin: 16px 0;
    }

    .bal-card {
      padding: 14px;
      border-radius: 10px;
      background: var(--surface2);
      border: 1px solid var(--border);
    }

    .bal-key {
      font-family: 'DM Mono', monospace;
      font-size: 10px;
      font-weight: 500;
      color: var(--muted);
      letter-spacing: .08em;
      text-transform: uppercase;
      margin-bottom: 6px;
    }

    .bal-val {
      font-family: 'DM Mono', monospace;
      font-size: 18px;
      font-weight: 500;
      color: var(--text);
    }

    .table-wrap {
      border: 1px solid var(--border);
      border-radius: 10px;
      overflow: hidden;
      background: var(--surface2);
      margin-top: 4px;
    }

    table { width: 100%; border-collapse: collapse; font-size: 13px; }

    thead { background: var(--surface3); border-bottom: 1px solid var(--border); }

    th {
      padding: 10px 12px;
      text-align: left;
      font-family: 'DM Mono', monospace;
      font-size: 10px;
      font-weight: 500;
      color: var(--muted);
      letter-spacing: .07em;
      text-transform: uppercase;
    }

    td {
      padding: 10px 12px;
      border-bottom: 1px solid var(--border);
      vertical-align: top;
      font-family: 'DM Mono', monospace;
      font-size: 12px;
      color: var(--text);
    }

    tbody tr:last-child td { border-bottom: none; }
    tbody tr:hover { background: rgba(255,255,255,.02); }

    .td-pos { color: var(--green); }
    .td-neg { color: var(--red); }

    .je-note {
      font-size: 12px;
      color: var(--muted2);
      line-height: 1.7;
      margin-top: 14px;
      padding: 14px;
      border-left: 2px solid var(--border);
    }

    .je-note b { color: var(--text); }

    /* ===== FINANCIAL STATEMENTS ===== */
    .statements-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
      margin-top: 20px;
    }

    @media (max-width: 700px) { .statements-grid { grid-template-columns: 1fr; } }

    .stmt-card {
      padding: 20px;
      border-radius: 11px;
      background: var(--surface2);
      border: 1px solid var(--border);
      display: flex;
      gap: 14px;
      align-items: flex-start;
    }

    .stmt-num {
      width: 32px; height: 32px;
      border-radius: 8px;
      background: var(--gold-dim);
      border: 1px solid rgba(212,168,67,.2);
      display: grid;
      place-items: center;
      font-family: 'Playfair Display', serif;
      font-size: 15px;
      font-weight: 700;
      color: var(--gold);
      flex-shrink: 0;
    }

    .stmt-text b {
      display: block;
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .stmt-text p {
      font-size: 13px;
      color: var(--muted);
      line-height: 1.6;
    }

    /* ===== SUMMARY ===== */
    .summary-grid {
      display: grid;
      gap: 10px;
      margin-top: 20px;
    }

    .summary-item {
      display: flex;
      gap: 12px;
      align-items: flex-start;
      padding: 14px 16px;
      border-radius: 10px;
      background: var(--surface2);
      border: 1px solid var(--border);
    }

    .summary-num {
      font-family: 'DM Mono', monospace;
      font-size: 12px;
      font-weight: 500;
      color: var(--green);
      padding-top: 2px;
      flex-shrink: 0;
    }

    .summary-text {
      font-size: 14px;
      line-height: 1.7;
      color: var(--muted);
    }

    .summary-text b { color: var(--text); }

    /* ===== COMING SOON ===== */
    .coming-section {
      border-top: 1px solid var(--border);
      padding: 40px;
      text-align: center;
    }

    .coming-section h2 {
      font-family: 'Playfair Display', serif;
      font-size: 22px;
      font-weight: 700;
      color: var(--muted);
      margin-bottom: 10px;
    }

    .coming-section p {
      font-size: 14px;
      color: var(--muted2);
      max-width: 540px;
      margin: 0 auto;
      line-height: 1.7;
    }

    /* ===== FOOTER ===== */
    .ch-footer {
      border-top: 1px solid var(--border);
      padding: 20px 40px;
      font-family: 'DM Mono', monospace;
      font-size: 11px;
      color: var(--muted2);
      text-align: center;
      letter-spacing: .04em;
    }

    /* ===== TOAST ===== */
    #toast {
      position: fixed;
      bottom: 24px;
      right: 24px;
      background: var(--surface2);
      border: 1px solid var(--green-bright);
      color: var(--green);
      font-family: 'DM Mono', monospace;
      font-size: 12px;
      font-weight: 500;
      padding: 10px 18px;
      border-radius: 8px;
      opacity: 0;
      transition: opacity .25s;
      pointer-events: none;
      z-index: 9999;
    }

    #toast.show { opacity: 1; }

    @media (max-width: 920px) {
      .je-grid { grid-template-columns: 1fr 1fr; }
    }

    @media (max-width: 600px) {
      .ch-hero { padding: 32px 20px; }
      .section { padding: 28px 20px; }
      .balances-row { grid-template-columns: 1fr; }
    }

    /* ============================================================
       ANIMATIONS
    ============================================================ */

    /* --- 1. Equation shake (unbalanced) --- */
    @keyframes shake {
      0%,100% { transform: translateX(0); }
      12%      { transform: translateX(-7px); }
      25%      { transform: translateX( 7px); }
      37%      { transform: translateX(-5px); }
      50%      { transform: translateX( 5px); }
      62%      { transform: translateX(-3px); }
      75%      { transform: translateX( 3px); }
      88%      { transform: translateX(-1px); }
    }
    .shake { animation: shake 0.52s cubic-bezier(.36,.07,.19,.97) both; }

    /* --- 2. Slider glow pulse while dragging --- */
    @keyframes thumbPulse {
      0%,100% { box-shadow: 0 0 8px rgba(45,186,126,.45); }
      50%      { box-shadow: 0 0 22px rgba(45,186,126,.9), 0 0 40px rgba(45,186,126,.35); }
    }
    input[type="range"].dragging::-webkit-slider-thumb {
      animation: thumbPulse 0.75s ease-in-out infinite;
    }
    input[type="range"].dragging::-moz-range-thumb {
      animation: thumbPulse 0.75s ease-in-out infinite;
    }
    /* Track highlight while dragging */
    input[type="range"].dragging {
      background: linear-gradient(90deg, rgba(45,186,126,.3) var(--pct,0%), rgba(255,255,255,.06) var(--pct,0%));
    }

    /* --- 3. Journal row flash --- */
    @keyframes flashGreen {
      0%   { background: rgba(45,186,126,.28); }
      100% { background: transparent; }
    }
    @keyframes flashRed {
      0%   { background: rgba(240,96,96,.22); }
      100% { background: transparent; }
    }
    tr.flash-green { animation: flashGreen 0.9s ease forwards; }
    tr.flash-red   { animation: flashRed   0.55s ease forwards; }

    /* --- 4. Confetti particles --- */
    .confetti-dot {
      position: fixed;
      width: 7px; height: 7px;
      border-radius: 50%;
      pointer-events: none;
      z-index: 9998;
      will-change: transform, opacity;
    }

    /* --- 5. Floating hero particles (canvas) --- */
    #heroParticleCanvas {
      position: absolute;
      inset: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      z-index: 0;
    }

    /* --- 6. Falling money canvas --- */
    #moneyCanvas {
      position: absolute;
      inset: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      z-index: 0;
    }

    /* --- 7. Cursor trail (canvas) --- */
    #cursorCanvas {
      position: fixed;
      inset: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      z-index: 9990;
    }

    /* Make ch-hero a stacking context so canvas stays behind content */
    .ch-hero { isolation: isolate; }
    .ch-hero-inner { position: relative; z-index: 1; }
  </style>
</head>
<body>

  <!-- NAV -->
  <nav>
    <a href="index.html" class="nav-brand">
      <div class="nav-logo"><img src="logo-accounting-by-noah.png" alt="Accounting By Noah logo"></div>
      <div class="nav-brand-text">
        Accounting By Noah
        <small>Learning Portal</small>
      </div>
    </a>
    <div class="nav-spacer"></div>
    <div class="nav-pill">
      <span style="font-size:11px;color:var(--muted);font-family:'DM Mono',monospace;letter-spacing:.06em;flex-shrink:0;">CH</span>
      <select id="chapterSelect" onchange="selectChapterFromDropdown()">
        <option value="1" selected>01 — Intro to Accounting & Business</option>
        <option value="2">02 — Coming Soon</option>
        <option value="3">03 — Coming Soon</option>
        <option value="4">04 — Coming Soon</option>
        <option value="5">05 — Coming Soon</option>
        <option value="6">06 — Coming Soon</option>
        <option value="7">07 — Coming Soon</option>
        <option value="8">08 — Coming Soon</option>
        <option value="9">09 — Coming Soon</option>
        <option value="10">10 — Coming Soon</option>
        <option value="11">11 — Coming Soon</option>
        <option value="12">12 — Coming Soon</option>
        <option value="13">13 — Coming Soon</option>
        <option value="14">14 — Coming Soon</option>
      </select>
    </div>
    <button class="nav-btn" onclick="toggleStudyMode()">Study Mode</button>
    <button class="nav-btn green" onclick="scrollTo('obj5')">Mastery Check</button>
  </nav>

  <div id="toast">Copied</div>

  <!-- Cursor trail canvas (full page) -->
  <canvas id="cursorCanvas"></canvas>

  <!-- WRAP -->
  <div class="wrap">

    <!-- SIDEBAR -->
    <aside class="sidebar">
      <div class="sidebar-head">
        <div class="sidebar-label">Curriculum</div>
        <div class="sidebar-title">14 Chapters</div>
        <div class="sidebar-sub">Chapter 1 is live. The rest are scaffolded and ready to fill in.</div>
      </div>
      <div class="ch-list" id="chapterList"></div>
    </aside>

    <!-- CONTENT -->
    <main class="content">

      <!-- CHAPTER HERO -->
      <div class="ch-hero" id="hero">
        <canvas id="heroParticleCanvas"></canvas>
        <canvas id="moneyCanvas"></canvas>
        <div class="ch-hero-inner">
          <div class="ch-tag">Chapter 01 — Active</div>
          <h1 id="heroTitle">Introduction to Accounting & Business</h1>
          <p id="heroDesc">This chapter teaches, not just dumps definitions. Read a topic in plain English, understand why it matters, then apply it immediately with an interactive tool. About 3 simulators per chapter — focused, not overwhelming.</p>
          <div class="ch-hero-actions">
            <a href="#obj1" class="jump-btn primary">Start Lesson →</a>
            <a href="#eqPractice" class="jump-btn">Practice Equation</a>
            <a href="#jePractice" class="jump-btn">Practice Journal Entries</a>
          </div>
        </div>
      </div>

      <!-- ===== LEARNING OBJECTIVES OVERVIEW ===== -->
      <section class="section" id="obj0">
        <div class="section-title-row">
          <span class="obj-badge">Overview</span>
          <h2>Learning Objectives</h2>
        </div>
        <p class="section-intro">We'll build this chapter in the same order your brain actually learns: first the big idea, then the vocabulary, then the system behind it. Start with what businesses are trying to do, then why accounting exists, then the rules (GAAP), the equation, and finally how it all becomes financial statements.</p>
        <div class="terms">
          <div class="term"><span class="term-tag">01</span><div class="term-body"><b>Nature of Business & Accounting</b> — What a business is, why profit matters, and what accounting actually tracks.</div></div>
          <div class="term"><span class="term-tag">02</span><div class="term-body"><b>GAAP</b> — The shared rulebook for financial reporting: assumptions, principles, and why consistency matters.</div></div>
          <div class="term"><span class="term-tag">03</span><div class="term-body"><b>The Accounting Equation</b> — Assets = Liabilities + Equity. The structural backbone of every transaction.</div></div>
          <div class="term"><span class="term-tag">04</span><div class="term-body"><b>Transactions & Journal Entries</b> — How accountants officially record changes using debits and credits.</div></div>
          <div class="term"><span class="term-tag">05</span><div class="term-body"><b>Financial Statements</b> — The four reports every business produces, and how they connect.</div></div>
        </div>
      </section>

      <!-- ===== OBJ 1: NATURE OF BUSINESS ===== -->
      <section class="section" id="obj1">
        <div class="section-title-row">
          <span class="obj-badge">Objective 01</span>
          <h2>Nature of Business & Accounting</h2>
        </div>
        <p class="section-intro">A business takes resources—money, time, materials, labor—and turns them into something people will pay for. Accounting is the system that tracks whether that process is working.</p>
        <div class="terms">
          <div class="term"><span class="term-tag">Business</span><div class="term-body">A business takes resources and converts them into products or services, trying to do it efficiently enough to earn a profit. Every decision a business makes connects back to this goal.</div></div>
          <div class="term"><span class="term-tag">Profit</span><div class="term-body">Profit is what's left after paying for everything it took to earn that revenue. Businesses track this obsessively because it drives almost every financial decision.</div></div>
          <div class="term"><span class="term-tag">Accounting</span><div class="term-body">Accounting is the system for recording, organizing, and reporting a business's financial activity. It answers: What do we own? What do we owe? Did we make money?</div></div>
        </div>
        <div class="eq-box">
          <code>Profit = Revenues − Expenses</code>
          <button class="copy-btn" onclick="copyText('Profit = Revenues − Expenses')">Copy</button>
        </div>
        <div class="quiz-block">
          <div class="quiz-label">Mini Quiz — What is profit equal to?</div>
          <input class="quiz-input" id="q_profit" placeholder="Type the formula…" />
          <div class="quiz-row">
            <button class="quiz-check-btn" onclick="checkProfit()">Check Answer</button>
            <span class="result-badge" id="r_profit"></span>
            <span class="quiz-hint">Include both Revenues and Expenses.</span>
          </div>
        </div>
      </section>

      <!-- ===== OBJ 2: GAAP ===== -->
      <section class="section" id="obj2">
        <div class="section-title-row">
          <span class="obj-badge">Objective 02</span>
          <h2>GAAP — Generally Accepted Accounting Principles</h2>
        </div>
        <p class="section-intro">GAAP is the shared rulebook for financial reporting. Without it, two companies could record similar transactions in completely different ways — making statements confusing and impossible to compare.</p>
        <div class="gaap-grid">
          <div class="gaap-card">
            <div class="gaap-card-label">Assumptions</div>
            <p><b>Monetary unit</b> — record in dollars. <b>Time period</b> — report by month, quarter, or year. <b>Business entity</b> — the business is separate from its owner. <b>Going concern</b> — assume the business will keep operating.</p>
          </div>
          <div class="gaap-card">
            <div class="gaap-card-label">Principles</div>
            <p><b>Historical cost</b> — record items at a reliable, objective amount. <b>Revenue recognition</b> — record revenue when earned. <b>Expense recognition</b> — match expenses to the period they help generate revenue.</p>
          </div>
        </div>
        <div style="margin-top: 20px;">
          <div class="quiz-label" style="font-size: 13px; color: var(--muted); margin-bottom: 10px;">Flashcard — click to reveal</div>
          <div class="flashcard" id="fc1" onclick="flipCard()">What does GAAP stand for?</div>
          <p style="font-size:12px; color:var(--muted2); margin-top:10px;">Tap to flip. More flashcard stacks can be added per chapter.</p>
        </div>
      </section>

      <!-- ===== OBJ 3: ACCOUNTING EQUATION ===== -->
      <section class="section" id="obj3">
        <div class="section-title-row">
          <span class="obj-badge">Objective 03</span>
          <h2>The Accounting Equation</h2>
        </div>
        <p class="section-intro">The accounting equation is the backbone of accounting. If a business has assets, those assets came from somewhere: either they borrowed the money (liabilities) or the owners invested / the business kept profits (equity). That's why it always balances.</p>
        <div class="eq-box">
          <code>Assets = Liabilities + Equity</code>
          <button class="copy-btn" onclick="copyText('Assets = Liabilities + Equity')">Copy</button>
        </div>
        <div class="terms" style="margin-top: 16px;">
          <div class="term"><span class="term-tag">Assets</span><div class="term-body">What the business owns or controls — cash, supplies, equipment, receivables, inventory.</div></div>
          <div class="term"><span class="term-tag">Liabilities</span><div class="term-body">What the business owes to others — loans, accounts payable, wages owed, unearned revenue.</div></div>
          <div class="term"><span class="term-tag">Equity</span><div class="term-body">The owner's claim after liabilities. Includes owner investments and profits kept in the business (retained earnings).</div></div>
        </div>
        <p style="font-size:13px; color:var(--muted); margin-top:18px; line-height:1.7;">Now use the simulator below to test this. Move Assets and watch what has to happen on the other side. Train your eyes to think: <em>if one side changes, the other must too.</em></p>
      </section>

      <!-- ===== EQUATION SIMULATOR ===== -->
      <section class="section" id="eqPractice">
        <div class="sim-header">
          <h3>Equation Visualizer</h3>
          <div class="sim-controls">
            <button class="sim-btn" id="abBtn" onclick="toggleAutoBalance()">Auto-Balance: <span id="abStatus">ON</span></button>
            <button class="sim-btn" onclick="resetSliders()">Reset</button>
          </div>
        </div>

        <div class="slider-grid">
          <div class="slider-card">
            <div class="slider-row">
              <span class="slider-label">ΔAssets</span>
              <span class="slider-val" id="aVal">$0</span>
            </div>
            <input type="range" min="0" max="1000000" value="0" step="1000" id="assetsSlider" oninput="syncFromAssets()" />
          </div>
          <div class="slider-card">
            <div class="slider-row">
              <span class="slider-label">ΔLiabilities</span>
              <span class="slider-val" id="lVal">$0</span>
            </div>
            <input type="range" min="0" max="1000000" value="0" step="1000" id="liabSlider" oninput="manualChange('L')" />
          </div>
          <div class="slider-card">
            <div class="slider-row">
              <span class="slider-label">ΔEquity</span>
              <span class="slider-val" id="eVal">$0</span>
            </div>
            <input type="range" min="0" max="1000000" value="0" step="1000" id="eqSlider" oninput="manualChange('E')" />
          </div>
          <div class="slider-card">
            <div class="slider-row">
              <span class="slider-label">Status</span>
              <span id="eqStatus" style="font-family:'DM Mono',monospace; font-size:13px; color:var(--green);">Balanced ✓</span>
            </div>
            <div class="slider-mini" id="eqHint">Move the Assets slider first. The other side will adjust automatically — that's the balancing rule in action.</div>
          </div>
        </div>

        <div class="eq-line-display">
          <code id="eqLine">ΔA ($0) = ΔL ($0) + ΔE ($0)</code>
          <button class="copy-btn" onclick="copyText(document.getElementById('eqLine').innerText)">Copy</button>
        </div>
      </section>

      <!-- ===== OBJ 4: TRANSACTIONS & JOURNAL ENTRIES ===== -->
      <section class="section" id="obj4">
        <div class="section-title-row">
          <span class="obj-badge">Objective 04</span>
          <h2>Transactions & Journal Entries</h2>
        </div>
        <p class="section-intro">Every transaction changes the accounting equation, and journal entries are the official way accountants record those changes. Debits and credits don't simply mean "plus" and "minus" — they depend on the type of account.</p>
        <div class="terms">
          <div class="term"><span class="term-tag">Journal Entry</span><div class="term-body">A two-sided record of a transaction. Every entry has at least one debit and one credit, and the total debits must equal total credits. This keeps the equation balanced.</div></div>
          <div class="term"><span class="term-tag">Debit</span><div class="term-body">Left side of a journal entry. Increases Assets and Expenses; decreases Liabilities, Equity, and Revenue.</div></div>
          <div class="term"><span class="term-tag">Credit</span><div class="term-body">Right side of a journal entry. Increases Liabilities, Equity, and Revenue; decreases Assets and Expenses.</div></div>
        </div>
      </section>

      <!-- ===== JOURNAL ENTRY TOOL ===== -->
      <section class="section" id="jePractice">
        <div class="sim-header">
          <h3>Journal Entry Simulator</h3>
        </div>

        <div class="je-grid">
          <select class="je-select" id="debitType">
            <option value="Asset">Debit — Asset</option>
            <option value="Liability">Debit — Liability</option>
            <option value="Equity">Debit — Equity</option>
            <option value="Revenue">Debit — Revenue</option>
            <option value="Expense">Debit — Expense</option>
            <option value="Dividends">Debit — Dividends</option>
          </select>
          <select class="je-select" id="creditType">
            <option value="Asset">Credit — Asset</option>
            <option value="Liability" selected>Credit — Liability</option>
            <option value="Equity">Credit — Equity</option>
            <option value="Revenue">Credit — Revenue</option>
            <option value="Expense">Credit — Expense</option>
            <option value="Dividends">Credit — Dividends</option>
          </select>
          <input class="je-input" type="number" id="jeAmount" placeholder="Amount $" min="0" step="100" />
          <div style="display:flex;gap:8px;">
            <button class="je-btn add" onclick="addEntry()" style="flex:1;">Add</button>
          </div>
        </div>

        <div class="je-row">
          <button class="je-btn undo" onclick="undoEntry()">↩ Undo</button>
          <button class="je-btn reset" onclick="resetJournal()">Reset All</button>
          <span class="result-badge" id="jeStatus"></span>
        </div>

        <div class="balances-row" style="margin-top:18px;">
          <div class="bal-card">
            <div class="bal-key">Assets</div>
            <div class="bal-val" id="balA">$0</div>
          </div>
          <div class="bal-card">
            <div class="bal-key">Liabilities</div>
            <div class="bal-val" id="balL">$0</div>
          </div>
          <div class="bal-card">
            <div class="bal-key">Equity</div>
            <div class="bal-val" id="balE">$0</div>
          </div>
        </div>

        <div class="eq-line-display" style="margin-bottom:12px;">
          <code id="balEqLine">A ($0) = L ($0) + E ($0)</code>
          <button class="copy-btn" onclick="copyText(document.getElementById('balEqLine').innerText)">Copy</button>
        </div>

        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th>#</th><th>Debit</th><th>Credit</th><th>Amount</th>
                <th>ΔAssets</th><th>ΔLiab</th><th>ΔEquity</th>
              </tr>
            </thead>
            <tbody id="jeBody">
              <tr><td colspan="7" style="color:var(--muted2);text-align:center;">No entries yet.</td></tr>
            </tbody>
          </table>
        </div>

        <div class="je-note">
          <b>Quick rule:</b> Debits usually increase Assets and decrease the right side (Liabilities / Equity), depending on account type. Credits do the opposite. This table translates those effects into changes in A/L/E so you can see the big picture.
        </div>
      </section>

      <!-- ===== OBJ 5: FINANCIAL STATEMENTS ===== -->
      <section class="section" id="obj5">
        <div class="section-title-row">
          <span class="obj-badge">Objective 05</span>
          <h2>Financial Statements</h2>
        </div>
        <p class="section-intro">The four financial statements are the final output of the accounting system. They connect to each other: net income flows into retained earnings, retained earnings flows into equity, and cash ties everything together.</p>

        <div class="statements-grid">
          <div class="stmt-card">
            <div class="stmt-num">1</div>
            <div class="stmt-text">
              <b>Income Statement</b>
              <p>Reports revenues and expenses for a period and calculates net income (or net loss). The bottom line of operations.</p>
            </div>
          </div>
          <div class="stmt-card">
            <div class="stmt-num">2</div>
            <div class="stmt-text">
              <b>Retained Earnings Statement</b>
              <p>Shows how retained earnings changed: starting balance + net income − dividends = ending retained earnings.</p>
            </div>
          </div>
          <div class="stmt-card">
            <div class="stmt-num">3</div>
            <div class="stmt-text">
              <b>Balance Sheet</b>
              <p>A snapshot of assets, liabilities, and equity at a specific point in time. This is where the accounting equation lives.</p>
            </div>
          </div>
          <div class="stmt-card">
            <div class="stmt-num">4</div>
            <div class="stmt-text">
              <b>Statement of Cash Flows</b>
              <p>Tracks cash receipts and payments, grouped into operating, investing, and financing activities.</p>
            </div>
          </div>
        </div>

        <div class="quiz-block" style="margin-top: 24px;">
          <div class="quiz-label">Mastery Check — Which statement reports assets, liabilities, and equity at a specific date?</div>
          <input class="quiz-input" id="q_bs" placeholder="Type your answer…" />
          <div class="quiz-row">
            <button class="quiz-check-btn" onclick="checkBalanceSheet()">Check Answer</button>
            <span class="result-badge" id="r_bs"></span>
          </div>
        </div>
      </section>

      <!-- ===== CHAPTER SUMMARY ===== -->
      <section class="section" id="summary">
        <div class="section-title-row">
          <span class="obj-badge">Summary</span>
          <h2>Chapter Summary</h2>
        </div>
        <p class="section-intro">If you remember nothing else from Chapter 1: accounting is a system for explaining what a business owns, owes, earns, and spends. The equation is the core structure. The financial statements are the final output.</p>
        <div class="summary-grid">
          <div class="summary-item"><span class="summary-num">01</span><div class="summary-text">Businesses exist to provide goods or services and earn a profit. <b>Accounting tracks what's happening financially</b>, and ethics matters because people rely on that information.</div></div>
          <div class="summary-item"><span class="summary-num">02</span><div class="summary-text"><b>GAAP</b> gives structure to financial reporting. Good accounting information must be useful, accurate, and consistent — that's what the assumptions and principles ensure.</div></div>
          <div class="summary-item"><span class="summary-num">03</span><div class="summary-text">The accounting equation is the foundation: <b>Assets = Liabilities + Equity</b>. What the business owns must equal what it owes plus the owners' claim.</div></div>
          <div class="summary-item"><span class="summary-num">04</span><div class="summary-text">Every transaction changes at least one part of the equation — <b>but the equation still has to balance afterward</b>.</div></div>
          <div class="summary-item"><span class="summary-num">05</span><div class="summary-text">The financial statements connect: net income → retained earnings → equity on the balance sheet. <b>Cash ties everything together</b> via the cash flow statement.</div></div>
        </div>
      </section>

      <!-- COMING SOON -->
      <div class="coming-section" id="comingSoon">
        <h2 id="comingTitle">Chapters 2–14</h2>
        <p id="comingText">This portal is structured for 14 chapters. When you add Chapter 2+, paste each chapter's content into the data structure and the UI will populate automatically.</p>
      </div>

      <div class="ch-footer">
        Accounting By Noah &nbsp;·&nbsp; Chapter 01 of 14 &nbsp;·&nbsp; Equation tools included
      </div>

    </main>
  </div>

  <script>
    // ===== Chapter Navigation =====
    const chapters = Array.from({length: 14}, (_, i) => {
      const n = i + 1;
      return { num: n, title: n === 1 ? "Intro to Accounting & Business" : "Coming Soon", status: n === 1 ? "Active" : "Planned", active: n === 1 };
    });

    const chapterList = document.getElementById("chapterList");
    const chapterSelect = document.getElementById("chapterSelect");

    function renderChapters() {
      chapterList.innerHTML = "";
      chapters.forEach(ch => {
        const btn = document.createElement("button");
        btn.className = "ch-btn" + (ch.active ? " active" : "");
        btn.onclick = () => goChapter(ch.num);
        btn.innerHTML = `
          <div class="ch-num">${String(ch.num).padStart(2,'0')}</div>
          <div class="ch-text">
            <b>${escapeHtml(ch.title)}</b>
            <span>${escapeHtml(ch.status)}</span>
          </div>
        `;
        chapterList.appendChild(btn);
      });
    }

    function goChapter(n) {
      chapters.forEach(c => c.active = (c.num === n));
      renderChapters();
      chapterSelect.value = String(n);
      if (n === 1) {
        document.getElementById("heroTitle").textContent = "Introduction to Accounting & Business";
        document.getElementById("heroDesc").textContent = "This chapter teaches, not just dumps definitions. Read a topic in plain English, understand why it matters, then apply it immediately with an interactive tool.";
        document.getElementById("comingTitle").textContent = "Chapters 2–14";
        document.getElementById("comingText").textContent = "This portal is structured for 14 chapters. Add Chapter 2+ by pasting content into the data structure.";
      } else {
        document.getElementById("heroTitle").textContent = `Chapter ${n} — Coming Soon`;
        document.getElementById("heroDesc").textContent = "This chapter slot is scaffolded and ready. Add lesson content and it will render here automatically.";
        document.getElementById("comingTitle").textContent = `Chapter ${n}`;
        document.getElementById("comingText").textContent = "Add objectives, key terms, practice problems, quizzes, and simulators here. The navigation and layout are complete.";
      }
      scrollTo("hero");
    }

    function selectChapterFromDropdown() {
      goChapter(parseInt(chapterSelect.value, 10));
    }

    // ===== Utilities =====
    function scrollTo(id) {
      const el = document.getElementById(id);
      if (el) el.scrollIntoView({ behavior: "smooth", block: "start" });
    }

    let toastTimer;
    function showToast(msg) {
      const t = document.getElementById("toast");
      t.textContent = msg;
      t.classList.add("show");
      clearTimeout(toastTimer);
      toastTimer = setTimeout(() => t.classList.remove("show"), 1400);
    }

    function copyText(text) {
      navigator.clipboard.writeText(text).then(() => showToast("Copied")).catch(() => showToast("Copy failed"));
    }

    function escapeHtml(s) {
      return String(s).replace(/[&<>"']/g, m => ({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[m]);
    }

    // ===== Quiz Checks =====
    function checkProfit() {
      const v = (document.getElementById("q_profit").value || "").toLowerCase();
      const ok = (v.includes("revenue") || v.includes("revenues")) && (v.includes("expense") || v.includes("expenses"));
      setResult("r_profit", ok ? "Correct ✓" : "Review: Profit = Revenues − Expenses", ok ? "good" : "bad");
      if (ok) spawnConfetti(document.querySelector('#obj1 .quiz-check-btn'));
    }

    function checkBalanceSheet() {
      const v = (document.getElementById("q_bs").value || "").toLowerCase();
      const ok = v.includes("balance");
      setResult("r_bs", ok ? "Correct ✓" : "Answer: Balance Sheet", ok ? "good" : "bad");
      if (ok) spawnConfetti(document.querySelector('#obj5 .quiz-check-btn'));
    }

    function setResult(id, msg, cls) {
      const el = document.getElementById(id);
      el.textContent = msg;
      el.className = "result-badge show " + cls;
    }

    // ===== Flashcard =====
    let fcState = 0;
    function flipCard() {
      const card = document.getElementById("fc1");
      fcState = (fcState + 1) % 2;
      card.textContent = fcState === 1 ? "Generally Accepted Accounting Principles" : "What does GAAP stand for?";
      card.classList.toggle("flipped", fcState === 1);
    }

    // ===== Study Mode =====
    let studyMode = false;
    function toggleStudyMode() {
      studyMode = !studyMode;
      document.documentElement.style.setProperty("--bg", studyMode ? "#111418" : "#0d1117");
      document.documentElement.style.setProperty("--surface", studyMode ? "#1a1f27" : "#161b22");
      showToast(studyMode ? "Study Mode On" : "Study Mode Off");
    }

    // ===================================================
    // ANIMATION 1 — Equation Shake (unbalanced)
    // ===================================================
    function triggerShake(el) {
      el.classList.remove("shake");
      void el.offsetWidth; // force reflow
      el.classList.add("shake");
      el.addEventListener("animationend", () => el.classList.remove("shake"), { once: true });
    }

    // ===================================================
    // ANIMATION 2 — Slider Glow Pulse while dragging
    // ===================================================
    function initSliderGlow(slider) {
      function updateTrack() {
        const pct = ((slider.value - slider.min) / (slider.max - slider.min)) * 100;
        slider.style.setProperty("--pct", pct + "%");
        slider.style.background = `linear-gradient(90deg, rgba(45,186,126,.35) ${pct}%, rgba(255,255,255,.06) ${pct}%)`;
      }
      slider.addEventListener("mousedown",  () => slider.classList.add("dragging"));
      slider.addEventListener("touchstart", () => slider.classList.add("dragging"), { passive: true });
      slider.addEventListener("mouseup",    () => slider.classList.remove("dragging"));
      slider.addEventListener("touchend",   () => slider.classList.remove("dragging"));
      slider.addEventListener("input", updateTrack);
      updateTrack();
    }

    // ===================================================
    // ANIMATION 3 — Confetti Burst
    // ===================================================
    const CONFETTI_COLORS = ["#2dba7e","#d4a843","#4f9cf9","#f06060","#a78bfa","#fbbf24"];

    function spawnConfetti(btn) {
      if (!btn) return;
      const rect = btn.getBoundingClientRect();
      const cx = rect.left + rect.width / 2;
      const cy = rect.top + rect.height / 2;
      const count = 36;

      for (let i = 0; i < count; i++) {
        const dot = document.createElement("div");
        dot.className = "confetti-dot";
        const color = CONFETTI_COLORS[Math.floor(Math.random() * CONFETTI_COLORS.length)];
        const size  = 5 + Math.random() * 5;
        const isSquare = Math.random() > 0.5;
        dot.style.cssText = `
          left:${cx}px; top:${cy}px;
          width:${size}px; height:${size}px;
          background:${color};
          border-radius:${isSquare ? "2px" : "50%"};
        `;
        document.body.appendChild(dot);

        const angle   = (Math.PI * 2 * i) / count + (Math.random() - 0.5) * 0.5;
        const speed   = 90 + Math.random() * 140;
        const gravity = 180 + Math.random() * 120;
        const life    = 900 + Math.random() * 400;
        let vx = Math.cos(angle) * speed;
        let vy = Math.sin(angle) * speed - 60;
        let x  = cx, y = cy;
        const start = performance.now();

        (function animate(now) {
          const t = (now - start) / 1000;
          const progress = (now - start) / life;
          if (progress >= 1) { dot.remove(); return; }

          vy += gravity * (1/60);
          x += vx * (1/60);
          y += vy * (1/60);

          const opacity = 1 - Math.pow(progress, 2);
          const scale   = 1 - progress * 0.4;
          dot.style.transform = `translate(${x - cx}px, ${y - cy}px) scale(${scale}) rotate(${t * 360}deg)`;
          dot.style.opacity   = opacity;
          requestAnimationFrame(animate);
        })(start);
      }
    }

    // ===================================================
    // ANIMATION 4 — Journal Row Flash
    // ===================================================
    function flashRow(tr, cls) {
      tr.classList.add(cls);
      tr.addEventListener("animationend", () => tr.classList.remove(cls), { once: true });
    }

    // ===================================================
    // ANIMATION 5 — Floating Hero Particles
    // ===================================================
    function initHeroParticles() {
      const canvas = document.getElementById("heroParticleCanvas");
      const hero   = document.getElementById("hero");
      const ctx    = canvas.getContext("2d");
      let w, h, particles;

      function resize() {
        w = canvas.width  = hero.offsetWidth;
        h = canvas.height = hero.offsetHeight;
      }

      function makeParticle() {
        return {
          x: Math.random() * w,
          y: Math.random() * h,
          r: 0.8 + Math.random() * 1.4,
          vx: (Math.random() - 0.5) * 0.18,
          vy: -0.06 - Math.random() * 0.14,
          alpha: 0.1 + Math.random() * 0.35,
          flicker: Math.random() * Math.PI * 2,
          flickerSpeed: 0.008 + Math.random() * 0.012,
        };
      }

      function init() {
        resize();
        particles = Array.from({ length: 55 }, makeParticle);
      }

      function draw() {
        ctx.clearRect(0, 0, w, h);
        particles.forEach(p => {
          p.x += p.vx;
          p.y += p.vy;
          p.flicker += p.flickerSpeed;
          const a = p.alpha * (0.7 + 0.3 * Math.sin(p.flicker));

          if (p.x < -10) p.x = w + 10;
          if (p.x > w + 10) p.x = -10;
          if (p.y < -10) { p.y = h + 10; p.x = Math.random() * w; }

          ctx.beginPath();
          ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
          ctx.fillStyle = `rgba(45,186,126,${a})`;
          ctx.fill();
        });
        requestAnimationFrame(draw);
      }

      window.addEventListener("resize", () => { resize(); });
      init();
      draw();
    }

    // ===================================================
    // ANIMATION 6 — Gradient Mesh Shift
    // ===================================================
    function initGradientShift() {
      const hero = document.getElementById("hero");
      let t = 0;

      function update() {
        t += 0.003;
        const x1 = 50 + 50 * Math.sin(t * 0.7);
        const y1 = 40 + 20 * Math.cos(t * 0.5);
        const x2 = 50 + 50 * Math.cos(t * 0.4);
        const y2 = 60 + 20 * Math.sin(t * 0.9);

        hero.style.background = `
          radial-gradient(700px 280px at ${x1}% ${y1}%, rgba(45,186,126,.10), transparent),
          radial-gradient(600px 260px at ${x2}% ${y2}%, rgba(212,168,67,.07), transparent),
          var(--surface2)
        `;
        requestAnimationFrame(update);
      }
      update();
    }

    // ===================================================
    // ANIMATION 7 — Cursor Trail
    // ===================================================
    function initCursorTrail() {
      const canvas = document.getElementById("cursorCanvas");
      const ctx    = canvas.getContext("2d");
      let w = canvas.width  = window.innerWidth;
      let h = canvas.height = window.innerHeight;
      window.addEventListener("resize", () => {
        w = canvas.width  = window.innerWidth;
        h = canvas.height = window.innerHeight;
      });

      const TRAIL_LEN = 22;
      const trail = [];
      let mouse = { x: -200, y: -200 };
      let leader = { x: -200, y: -200 };

      window.addEventListener("mousemove", e => { mouse.x = e.clientX; mouse.y = e.clientY; });

      function draw() {
        // Lerp leader toward mouse
        leader.x += (mouse.x - leader.x) * 0.18;
        leader.y += (mouse.y - leader.y) * 0.18;

        trail.unshift({ x: leader.x, y: leader.y });
        if (trail.length > TRAIL_LEN) trail.pop();

        ctx.clearRect(0, 0, w, h);

        trail.forEach((pt, i) => {
          const progress = i / TRAIL_LEN;
          const radius   = (1 - progress) * 4.5;
          const alpha    = (1 - progress) * 0.45 * (1 - progress);

          ctx.beginPath();
          ctx.arc(pt.x, pt.y, Math.max(0.1, radius), 0, Math.PI * 2);
          ctx.fillStyle = `rgba(45,186,126,${alpha})`;
          ctx.fill();
        });

        requestAnimationFrame(draw);
      }
      draw();
    }

    // ===================================================
    // ANIMATION 8 — Falling Money
    // ===================================================
    function initFallingMoney() {
      const canvas = document.getElementById("moneyCanvas");
      const hero   = document.getElementById("hero");
      const ctx    = canvas.getContext("2d");
      let w, h;

      // Bill designs: foreground color, background fill, label
      const BILLS = [
        { bg: "#1a3a1e", fg: "#2dba7e",    label: "$100" },
        { bg: "#1e2f1a", fg: "#4ddf9a",    label: "$50"  },
        { bg: "#2a2010", fg: "#d4a843",    label: "$20"  },
        { bg: "#12201a", fg: "#1e9e68",    label: "$1"   },
      ];

      function resize() {
        w = canvas.width  = hero.offsetWidth;
        h = canvas.height = hero.offsetHeight;
      }

      function makeBill() {
        const bill = BILLS[Math.floor(Math.random() * BILLS.length)];
        const bw = 46 + Math.random() * 18;   // bill width
        const bh = bw * 0.44;                  // realistic aspect ratio
        const speed  = 0.55 + Math.random() * 1.1;
        const wobbleAmp   = 18 + Math.random() * 28;  // horizontal sway amplitude (px)
        const wobbleFreq  = 0.012 + Math.random() * 0.018;
        const wobblePhase = Math.random() * Math.PI * 2;
        const rotSpeed    = (Math.random() - 0.5) * 0.018; // radians per frame
        return {
          x:      Math.random() * (w + 60) - 30,
          y:      -bh - Math.random() * h * 0.6,   // stagger start positions
          bw, bh,
          speed,
          wobbleAmp, wobbleFreq, wobblePhase,
          rot:    (Math.random() - 0.5) * 0.5,
          rotSpeed,
          alpha:  0.13 + Math.random() * 0.22,
          bg:     bill.bg,
          fg:     bill.fg,
          label:  bill.label,
          frame:  0,
        };
      }

      function drawBill(b) {
        ctx.save();
        ctx.globalAlpha = b.alpha;
        ctx.translate(
          b.x + Math.sin(b.frame * b.wobbleFreq + b.wobblePhase) * b.wobbleAmp,
          b.y
        );
        ctx.rotate(b.rot);

        const rx = b.bw / 2, ry = b.bh / 2;
        const corner = 3;

        // Bill body
        ctx.beginPath();
        ctx.moveTo(-rx + corner, -ry);
        ctx.lineTo( rx - corner, -ry);
        ctx.quadraticCurveTo( rx, -ry,  rx, -ry + corner);
        ctx.lineTo( rx,  ry - corner);
        ctx.quadraticCurveTo( rx,  ry,  rx - corner,  ry);
        ctx.lineTo(-rx + corner,  ry);
        ctx.quadraticCurveTo(-rx,  ry, -rx,  ry - corner);
        ctx.lineTo(-rx, -ry + corner);
        ctx.quadraticCurveTo(-rx, -ry, -rx + corner, -ry);
        ctx.closePath();
        ctx.fillStyle = b.bg;
        ctx.fill();

        // Border line (inner)
        ctx.strokeStyle = b.fg;
        ctx.lineWidth = 0.7;
        ctx.globalAlpha = b.alpha * 0.6;
        ctx.beginPath();
        const pad = 2.5;
        ctx.rect(-rx + pad, -ry + pad, b.bw - pad * 2, b.bh - pad * 2);
        ctx.stroke();

        // Center oval portrait placeholder
        ctx.globalAlpha = b.alpha * 0.45;
        ctx.beginPath();
        ctx.ellipse(0, 0, rx * 0.22, ry * 0.52, 0, 0, Math.PI * 2);
        ctx.strokeStyle = b.fg;
        ctx.lineWidth = 0.8;
        ctx.stroke();

        // Dollar label (left)
        ctx.globalAlpha = b.alpha * 0.9;
        ctx.fillStyle = b.fg;
        ctx.font = `bold ${b.bh * 0.34}px "DM Mono", monospace`;
        ctx.textAlign = "left";
        ctx.textBaseline = "middle";
        ctx.fillText(b.label, -rx + 4.5, 0);

        // Dollar label (right, mirrored)
        ctx.textAlign = "right";
        ctx.fillText(b.label, rx - 4.5, 0);

        // Fine line serifs across bill
        ctx.globalAlpha = b.alpha * 0.15;
        ctx.strokeStyle = b.fg;
        ctx.lineWidth = 0.4;
        for (let i = -3; i <= 3; i++) {
          const lx = i * (rx * 0.28);
          ctx.beginPath();
          ctx.moveTo(lx, -ry + pad + 1);
          ctx.lineTo(lx, ry - pad - 1);
          ctx.stroke();
        }

        ctx.restore();
      }

      function init() {
        resize();
      }

      let bills = [];
      let initialized = false;

      function spawnInitialBills() {
        // Spread ~20 bills across the full height so they don't all arrive at once
        bills = Array.from({ length: 20 }, makeBill);
        // Distribute vertically at start so screen isn't empty
        bills.forEach(b => {
          b.y = Math.random() * (h + b.bh) - b.bh;
        });
      }

      function draw() {
        ctx.clearRect(0, 0, w, h);

        // Gradually spawn more bills up to cap of 22
        if (Math.random() < 0.018 && bills.length < 22) {
          bills.push(makeBill());
        }

        bills.forEach((b, i) => {
          b.frame++;
          b.y      += b.speed;
          b.rot    += b.rotSpeed;

          drawBill(b);

          // Recycle when off screen bottom
          if (b.y > h + b.bh + 10) {
            bills[i] = makeBill(); // reset from top
          }
        });

        requestAnimationFrame(draw);
      }

      window.addEventListener("resize", () => { resize(); });
      init();
      spawnInitialBills();
      draw();
    }
    let autoBalance = true;
    let leRatio = 0.5;
    const assetsSlider = document.getElementById("assetsSlider");
    const liabSlider   = document.getElementById("liabSlider");
    const eqSlider     = document.getElementById("eqSlider");

    function money(n) {
      return "$" + Math.max(0, Math.abs(n)).toLocaleString(undefined, { maximumFractionDigits: 0 });
    }

    function toggleAutoBalance() {
      autoBalance = !autoBalance;
      const btn = document.getElementById("abBtn");
      document.getElementById("abStatus").textContent = autoBalance ? "ON" : "OFF";
      btn.classList.toggle("active", autoBalance);
      document.getElementById("eqHint").textContent = autoBalance
        ? "Auto-Balance is ON. Assets are split between Liabilities and Equity in a fixed linked balance."
        : "Auto-Balance is OFF. Adjust any slider. Balance is checked live.";
      if (autoBalance) syncFromAssets();
      updateEqViz();
    }

    function resetSliders() {
      leRatio = 0.5;
      assetsSlider.value = liabSlider.value = eqSlider.value = 0;
      [assetsSlider, liabSlider, eqSlider].forEach(s => {
        s.style.background = "rgba(255,255,255,.06)";
      });
      updateEqViz();
    }

    function clamp(v, min, max, step) {
      v = Math.max(min, Math.min(max, v));
      return Math.round(v / step) * step;
    }

    function syncFromAssets() {
      const A = parseInt(assetsSlider.value, 10);
      if (autoBalance) {
        let L = clamp(Math.round(A * leRatio), 0, 1000000, 1000);
        if (L > A) L = A;
        liabSlider.value = clamp(L, 0, 1000000, 1000);
        eqSlider.value   = clamp(A - L, 0, 1000000, 1000);
      }
      // update track fill for all sliders
      [assetsSlider, liabSlider, eqSlider].forEach(s => {
        const pct = ((s.value - s.min) / (s.max - s.min)) * 100;
        s.style.background = `linear-gradient(90deg, rgba(45,186,126,.35) ${pct}%, rgba(255,255,255,.06) ${pct}%)`;
      });
      updateEqViz();
    }

    function manualChange(changed) {
      const A = parseInt(assetsSlider.value, 10);
      if (autoBalance) {
        let L = parseInt(liabSlider.value, 10);
        let E = parseInt(eqSlider.value, 10);
        if (changed === 'L') { L = clamp(L, 0, A, 1000); E = A - L; }
        else { E = clamp(E, 0, A, 1000); L = A - E; }
        liabSlider.value = clamp(L, 0, 1000000, 1000);
        eqSlider.value   = clamp(E, 0, 1000000, 1000);
        leRatio = A > 0 ? (L / A) : 0.5;
        document.getElementById("eqHint").textContent = "Auto-Balance: when Liabilities rise, Equity falls. L + E always equals Assets.";
      }
      // update track fill
      [assetsSlider, liabSlider, eqSlider].forEach(s => {
        const pct = ((s.value - s.min) / (s.max - s.min)) * 100;
        s.style.background = `linear-gradient(90deg, rgba(45,186,126,.35) ${pct}%, rgba(255,255,255,.06) ${pct}%)`;
      });
      updateEqViz();
    }

    function updateEqViz() {
      const A = parseInt(assetsSlider.value, 10);
      const L = parseInt(liabSlider.value, 10);
      const E = parseInt(eqSlider.value, 10);
      document.getElementById("aVal").textContent = money(A);
      document.getElementById("lVal").textContent = money(L);
      document.getElementById("eVal").textContent = money(E);
      document.getElementById("eqLine").textContent = `ΔA (${money(A)}) = ΔL (${money(L)}) + ΔE (${money(E)})`;
      const balanced = A === L + E;
      const s = document.getElementById("eqStatus");
      s.textContent = balanced ? "Balanced ✓" : "Not Balanced ✗";
      s.style.color = balanced ? "var(--green)" : "var(--red)";

      // SHAKE when unbalanced
      if (!balanced) {
        triggerShake(document.getElementById("eqLine").closest(".eq-line-display"));
      }
    }

    // ===== Journal Entry Tool =====
    let J = { A: 0, L: 0, E: 0, entries: [] };

    function typeEffectOnALE(type, side, amount) {
      const d = side === "D";
      let dA=0, dL=0, dE=0;
      if (type === "Asset")     dA += (d ? +1 : -1) * amount;
      else if (type === "Liability") dL += (d ? -1 : +1) * amount;
      else dE += (d ? -1 : +1) * amount;
      return { dA, dL, dE };
    }

    function applyDelta(dA, dL, dE) {
      J.A = Math.max(0, J.A + dA);
      J.L = Math.max(0, J.L + dL);
      J.E = Math.max(0, J.E + dE);
    }

    function addEntry() {
      const debit = document.getElementById("debitType").value;
      const credit = document.getElementById("creditType").value;
      const amt = parseFloat(document.getElementById("jeAmount").value || "0");
      if (!amt || amt <= 0) { setJeStatus("Enter a valid amount.", "warn"); return; }
      const d1 = typeEffectOnALE(debit, "D", amt);
      const d2 = typeEffectOnALE(credit, "C", amt);
      const dA = d1.dA + d2.dA, dL = d1.dL + d2.dL, dE = d1.dE + d2.dE;
      applyDelta(dA, dL, dE);
      J.entries.push({ debit, credit, amt, dA, dL, dE, isNew: true });
      renderJournal();
      setJeStatus("Entry added ✓", "good");
      document.getElementById("jeAmount").value = "";
    }

    function undoEntry() {
      if (!J.entries.length) { setJeStatus("Nothing to undo.", "warn"); return; }
      // Flash the last row red before removing
      const body = document.getElementById("jeBody");
      const lastRow = body.querySelector("tr:last-child");
      if (lastRow && body.children.length > 0) {
        lastRow.classList.add("flash-red");
        setTimeout(() => {
          const last = J.entries.pop();
          applyDelta(-last.dA, -last.dL, -last.dE);
          renderJournal();
        }, 300);
      } else {
        const last = J.entries.pop();
        applyDelta(-last.dA, -last.dL, -last.dE);
        renderJournal();
      }
      setJeStatus("Undid last entry.", "good");
    }

    function resetJournal() {
      J = { A: 0, L: 0, E: 0, entries: [] };
      renderJournal();
      setJeStatus("Reset.", "good");
    }

    let jeStatusTimer;
    function setJeStatus(msg, cls) {
      const el = document.getElementById("jeStatus");
      el.textContent = msg;
      el.className = "result-badge show " + cls;
      clearTimeout(jeStatusTimer);
      jeStatusTimer = setTimeout(() => { el.className = "result-badge"; }, 2500);
    }

    function fmtSigned(n) {
      const sign = n > 0 ? "+" : (n < 0 ? "−" : "");
      return sign + "$" + Math.abs(n).toLocaleString(undefined, { maximumFractionDigits: 0 });
    }

    function renderJournal() {
      const fmt = n => "$" + Math.max(0, n).toLocaleString(undefined, { maximumFractionDigits: 0 });
      document.getElementById("balA").textContent = fmt(J.A);
      document.getElementById("balL").textContent = fmt(J.L);
      document.getElementById("balE").textContent = fmt(J.E);
      document.getElementById("balEqLine").textContent = `A (${fmt(J.A)}) = L (${fmt(J.L)}) + E (${fmt(J.E)})`;
      const body = document.getElementById("jeBody");
      body.innerHTML = "";
      if (!J.entries.length) {
        body.innerHTML = `<tr><td colspan="7" style="color:var(--muted2);text-align:center;padding:20px;">No entries yet.</td></tr>`;
        return;
      }
      J.entries.forEach((e, i) => {
        const cls = (n) => n > 0 ? "td-pos" : (n < 0 ? "td-neg" : "");
        const tr = document.createElement("tr");
        if (e.isNew) { tr.classList.add("flash-green"); e.isNew = false; }
        tr.innerHTML = `
          <td>${i+1}</td>
          <td>${escapeHtml(e.debit)}</td>
          <td>${escapeHtml(e.credit)}</td>
          <td>$${e.amt.toLocaleString()}</td>
          <td class="${cls(e.dA)}">${fmtSigned(e.dA)}</td>
          <td class="${cls(e.dL)}">${fmtSigned(e.dL)}</td>
          <td class="${cls(e.dE)}">${fmtSigned(e.dE)}</td>
        `;
        body.appendChild(tr);
      });
    }

    // ===== Init everything =====
    renderChapters();
    resetSliders();
    renderJournal();
    document.getElementById("abBtn").classList.add("active");

    // Init slider glow on all range inputs
    document.querySelectorAll('input[type="range"]').forEach(initSliderGlow);

    // Init ambient animations
    initHeroParticles();
    initGradientShift();
    initFallingMoney();
    initCursorTrail();
  </script>
</body>
</html>
